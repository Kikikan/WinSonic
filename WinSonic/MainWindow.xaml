<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="WinSonic.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:WinSonic"
    xmlns:tb="using:H.NotifyIcon"  
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="WinSonic">

    <Window.SystemBackdrop>
        <MicaBackdrop />
    </Window.SystemBackdrop>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="30"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="auto"/>
        </Grid.RowDefinitions>
        <Grid.Resources>
            <Style x:Key="NonClickableMenuFlyoutItemStyle" TargetType="MenuFlyoutItem">
                <Setter Property="IsEnabled" Value="True" />
                <Setter Property="IsHitTestVisible" Value="False" />
                <Setter Property="Background" Value="Transparent" />
                <Setter Property="Foreground" Value="{ThemeResource SystemControlForegroundBaseHighBrush}" />
                <Setter Property="Padding" Value="4,2,4,2" />

                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="MenuFlyoutItem">
                            <Grid x:Name="RootGrid" Background="{TemplateBinding Background}">
                                <VisualStateManager.VisualStateGroups>
                                    <VisualStateGroup x:Name="CommonStates">
                                        <VisualState x:Name="Normal" />
                                        <VisualState x:Name="PointerOver" />
                                        <VisualState x:Name="Pressed" />
                                        <VisualState x:Name="Disabled" />
                                    </VisualStateGroup>
                                </VisualStateManager.VisualStateGroups>

                                <ContentPresenter
                            x:Name="ContentPresenter"
                            Content="{TemplateBinding Text}"
                            HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                            VerticalAlignment="Center"
                            Margin="0"
                            FontWeight="{TemplateBinding FontWeight}"
                            FontSize="{TemplateBinding FontSize}"
                            Foreground="{TemplateBinding Foreground}" />
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </Grid.Resources>
        <tb:TaskbarIcon
        x:Name="TrayIcon"
        x:FieldModifier="public"
        ContextMenuMode="SecondWindow"
        IconSource="Assets/Square44x44Logo.scale-200.ico"
        LeftClickCommand="{x:Bind ShowWindowCommand}"
        NoLeftClickDelay="True"
        ToolTipText="WinSonic">
            <tb:TaskbarIcon.ContextFlyout>
                <MenuFlyout AreOpenCloseAnimationsEnabled="False">
                    <MenuFlyoutItem
                        Text="WinSonic"
                        MinWidth="160"
                        HorizontalContentAlignment="Center"
                        FontWeight="Bold"
                        FontSize="14"
                        Style="{StaticResource NonClickableMenuFlyoutItemStyle}"
                        IsEnabled="True" />
                    <MenuFlyoutItem
                        Text="Ver 0.1"
                        MinWidth="160"
                        HorizontalContentAlignment="Center"
                        FontSize="11"
                        Style="{StaticResource NonClickableMenuFlyoutItemStyle}"
                        Foreground="Gray"
                        IsEnabled="True" />

                    <MenuFlyoutSeparator />

                    <MenuFlyoutItem
                        Command="{x:Bind ShowWindowCommand}"
                        Text="Show Window"
                        Padding="12,8"
                        MinWidth="160"
                        HorizontalContentAlignment="Stretch">
                        <MenuFlyoutItem.Icon>
                            <FontIcon Glyph="&#xe8a7;" />
                        </MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>

                    <MenuFlyoutItem
                        Command="{x:Bind ExitApplicationCommand}"
                        Text="Exit"
                        Padding="12,8"
                        MinWidth="160"
                        HorizontalContentAlignment="Stretch">
                        <MenuFlyoutItem.Icon>
                            <FontIcon Glyph="&#xe8bb;" />
                        </MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>
                </MenuFlyout>
            </tb:TaskbarIcon.ContextFlyout>
        </tb:TaskbarIcon>
        <Border x:Name="AppTitleBar" Grid.Row="0" VerticalAlignment="Top">
            <TextBlock x:Name="AppTitle" FontSize="12" Text="WinSonic" VerticalAlignment="Top" Margin="60 8 0 0" />
        </Border>
        <NavigationView x:Name="MainNav"
                        Grid.Row="1"
                        PaneDisplayMode="Left"
                        ItemInvoked="NavView_ItemInvoked"
                        IsBackEnabled="True"
                        IsBackButtonVisible="Visible"
                        BackRequested="MainNav_BackRequested">
            <NavigationView.MenuItems>
                <NavigationViewItem Tag="WinSonic.Pages.PlayerPage" Content="Now Playing">
                    <NavigationViewItem.Icon>
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xe768;" />
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
                <NavigationViewItemSeparator/>
                <NavigationViewItem Content="Favourites">
                    <NavigationViewItem.Icon>
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xe734;" />
                    </NavigationViewItem.Icon>
                    <NavigationViewItem.MenuItems>
                        <NavigationViewItem Content="Albums" Tag="WinSonic.Pages.Favourites.FavouriteAlbumPage">
                            <NavigationViewItem.Icon>
                                <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xe93c;" />
                            </NavigationViewItem.Icon>
                        </NavigationViewItem>
                        <NavigationViewItem Content="Artists" Tag="WinSonic.Pages.Favourites.FavouriteArtistPage">
                            <NavigationViewItem.Icon>
                                <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xe716;" />
                            </NavigationViewItem.Icon>
                        </NavigationViewItem>
                        <NavigationViewItem Content="Songs" Tag="WinSonic.Pages.Favourites.FavouriteSongPage">
                            <NavigationViewItem.Icon>
                                <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xec4f;" />
                            </NavigationViewItem.Icon>
                        </NavigationViewItem>
                    </NavigationViewItem.MenuItems>
                </NavigationViewItem>
                <NavigationViewItem Tag="WinSonic.Pages.AlbumsPage" Content="Albums">
                    <NavigationViewItem.Icon>
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xe93c;" />
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
                <NavigationViewItem Tag="WinSonic.Pages.ArtistsPage" Content="Artists">
                    <NavigationViewItem.Icon>
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xe716;" />
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
                <NavigationViewItem Tag="WinSonic.Pages.GenrePage" Content="Genres">
                    <NavigationViewItem.Icon>
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xe899;" />
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
                <NavigationViewItem Tag="WinSonic.Pages.PlaylistPage" Content="Playlists">
                    <NavigationViewItem.Icon>
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xea37;" />
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
                <NavigationViewItem Tag="WinSonic.Pages.SongsPage" Content="Songs">
                    <NavigationViewItem.Icon>
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xec4f;" />
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
                <NavigationViewItemSeparator/>
                <NavigationViewItem Content="Servers">
                    <NavigationViewItem.Icon>
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xe977;" />
                    </NavigationViewItem.Icon>
                    <NavigationViewItem.MenuItems>
                        <NavigationViewItem Content="Add" ToolTipService.ToolTip="Add a new Subsonic server" Tag="WinSonic.Pages.AddServerPage">
                            <NavigationViewItem.Icon>
                                <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xe710;" />
                            </NavigationViewItem.Icon>
                        </NavigationViewItem>
                        <NavigationViewItem Content="Edit" ToolTipService.ToolTip="Edit already added Subsonic servers" Tag="WinSonic.Pages.EditServerPage">
                            <NavigationViewItem.Icon>
                                <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xe70f;" />
                            </NavigationViewItem.Icon>
                        </NavigationViewItem>
                    </NavigationViewItem.MenuItems>
                </NavigationViewItem>
            </NavigationView.MenuItems>

            <Grid>
                <Frame x:Name="ContentFrame" IsTabStop="True"
                NavigationFailed="ContentFrame_NavigationFailed"/>
            </Grid>
        </NavigationView>
        <MediaPlayerElement x:Name="MediaPlayerElement" Grid.Row="2"
                   AreTransportControlsEnabled="True" AutoPlay="True"/>
    </Grid>
</Window>
